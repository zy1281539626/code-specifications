# GitFlow å·¥ä½œæµç¨‹è¦ç¯„

ç•¶åœ¨å¤šäººå”ä½œçš„åœ˜éšŠä¸­æˆ–æ¶‰åŠå¤šç’°å¢ƒéƒ¨ç½²ï¼ˆå¦‚é–‹ç™¼ã€æ¸¬è©¦ã€ç”Ÿç”¢ç’°å¢ƒï¼‰çš„å°ˆæ¡ˆæ™‚ï¼Œ GitFlow æä¾›äº†ä¸€å€‹å›ºå®šçš„ã€é æ¸¬æ€§å¼·çš„åˆ†æ”¯ç®¡ç†å’Œç™¼å¸ƒæµç¨‹ï¼Œæœ‰åŠ©æ–¼ç°¡åŒ–ç‰ˆæœ¬ç®¡ç†å’Œéƒ¨ç½²æµç¨‹ã€‚

# 1. Git ç‰ˆæœ¬ç®¡ç†

æœ¬ç‰ˆæœ¬å®šç¾©è¦ç¯„é©ç”¨æ–¼æ¡†æ¶é …ç›®åŠç›¸é—œæ¨¡å¡Šï¼ŒåŒ…æ‹¬é›¢ç·šåŒ…å¹³å°ã€çµ„ä»¶åº«ã€æ–‡æª”ç«™ç­‰ã€‚

## 1.1 ç‰ˆæœ¬è™Ÿå®šç¾©èªªæ˜

ç”¢å“çš„ç‰ˆæœ¬è™Ÿå®šç¾©ç”±3ä½æ•¸å­—çµ„æˆï¼Œå³vä¸»ç‰ˆæœ¬è™Ÿ.æ¬¡ç‰ˆæœ¬è™Ÿ.è¿­ä»£ç‰ˆæœ¬è™Ÿ-æ§‹å»ºç‰ˆæœ¬è™Ÿï¼Œåˆå§‹ç‰ˆæœ¬è™Ÿç‚ºv1.0.0-1ï¼›æ¯ä½ç‰ˆæœ¬è™Ÿç›¸äº’ç¨ç«‹ï¼Œäº’ä¸å½±éŸ¿ï¼Œ å¦‚ç›®å‰ç”¢å“ç‰ˆæœ¬è™Ÿç‚ºv1.0.0ï¼Œç•¶ç”¢å“ç™¼ç”Ÿé‡å¤§åŠŸèƒ½æ–°å¢æ™‚ï¼Œå³ç‰ˆæœ¬è™Ÿè®Šç‚ºv2.0.0ã€‚

- ä¸»ç‰ˆæœ¬è™Ÿï¼šå®šç¾©ç‚ºé‡å¤§æ¶æ§‹è®Šæ›´æˆ–é‡å¤§åŠŸèƒ½æ–°å¢æ™‚ä½¿ç”¨ï¼Œå¾1é–‹å§‹éå¢ï¼›
- æ¬¡ç‰ˆæœ¬è™Ÿï¼šå®šç¾©ç‚ºæ¶æ§‹èª¿æ•´æˆ–é‡å¤§åŠŸèƒ½èª¿æ•´æ™‚ä½¿ç”¨ï¼Œå¾0é–‹å§‹éå¢ï¼›
- è¿­ä»£ç‰ˆæœ¬è™Ÿï¼šå®šç¾©ç‚ºç‰ˆæœ¬è¿­ä»£æ™‚ä½¿ç”¨ï¼Œå¾0é–‹å§‹éå¢ï¼›
- å»ºæ§‹ç‰ˆæœ¬è™Ÿï¼šå®šç¾©ç‚ºæ¨¡çµ„çš„æ¶æ§‹ç‰ˆæœ¬ï¼Œå¾1é–‹å§‹éå¢**`ï¼ˆå†…éƒ¨é–‹ç™¼ã€æ¸¬è©¦ä½¿ç”¨ï¼Œä¸å…¬ä½ˆï¼‰`**ã€‚

## 1.2 ç‰ˆæœ¬è™Ÿè®Šæ›´èªªæ˜

- å¹³å°ç‰ˆæœ¬
    
    ç”±ä¸»ç‰ˆæœ¬è™Ÿ.æ¬¡ç‰ˆæœ¬è™Ÿ.è¿­ä»£ç‰ˆæœ¬è™Ÿçµ„æˆã€‚
    
    ![Untitled](/Untitled.png)
    
- ç”¢å“æ¨¡çµ„ç‰ˆæœ¬
    
    ç”±ä¸»ç‰ˆæœ¬è™Ÿ.æ¬¡ç‰ˆæœ¬è™Ÿ.è¿­ä»£ç‰ˆæœ¬è™Ÿ-å»ºæ§‹ç‰ˆæœ¬è™Ÿã€‚
    
    ![Untitled](/Untitled_1.png)
    
    ç”¢å“æ¨¡çµ„ç‰ˆæœ¬åˆ†ç‚ºè‡ªç ”èˆ‡é–‹æºæ¨¡çµ„ï¼š
    
    - è‡ªç ”æ¨¡çµ„ï¼šä¸»ç‰ˆæœ¬è™Ÿ.æ¬¡ç‰ˆæœ¬è™Ÿéœ€å¹³å°ç‰ˆæœ¬ä¿æŒä¸€è‡´
        
        è¿­ä»£ç‰ˆæœ¬è™Ÿå¦‚åœ¨ç•¶æ¬¡è¿­ä»£ç‰ˆæœ¬ç„¡æ›´æ–°ï¼Œå‰‡ä¿æŒè‡ªç ”æ¨¡çµ„æœ€æ–°è¿­ä»£ç‰ˆæœ¬è™Ÿï¼Œè‡ªç ”æ¨¡çµ„è¿­ä»£ç‰ˆæœ¬è™Ÿä¸å¾—è¶…éå¹³å°çš„è¿­ä»£ç‰ˆæœ¬è™Ÿ
        
        å…©å€‹ç›¸éš”å»ºæ§‹ç‰ˆæœ¬è™Ÿæœ‰æ©Ÿæœƒä¸é€£çºŒï¼Œä»¥å¯¦éš›å»ºæ§‹æ¬¡æ•¸éå¢ã€‚
        
        ä¾‹å¦‚ï¼š
        
        ```
        # FrameWork v1.0.0
        hub.hk.com/framework/components:v1.0.0-40
        hub.hk.com/framework/offline:v1.0.0-20
        hub.hk.com/framework/doc:v1.0.0-6
        ```
        
        è‹¥FrameWork v1.0.0 è¨ˆç•«åŠŸèƒ½è¿­ä»£å‡ç´šåˆ°v1.0.1ï¼Œå…¶ä¸­componentsç„¡è¿­ä»£è¨ˆç•«ï¼Œå‰‡ä¿æŒv1.0.0çš„ç‰ˆæœ¬ï¼š
        
        ```
        # FrameWork **v1.0.1**
        hub.hk.com/framework/components:**v1.0.0-40**
        hub.hk.com/framework/offline:v1.0.1-20
        hub.hk.com/framework/doc:v1.0.1-6
        ```
        
    - é–‹æºæ¨¡çµ„ï¼šæ¨¡çµ„åç¨±å’Œç‰ˆæœ¬è™Ÿä¿æŒå’Œé–‹æºçš„ä¸€è‡´å³å¯ã€‚

# 2. Git åˆ†æ”¯ç®¡ç†

åœ¨ä½¿ç”¨ Git çš„éç¨‹ä¸­å¦‚æœæ²’æœ‰æ¸…æ™°æµç¨‹å’Œè¦åŠƒï¼Œæ¯å€‹äººéƒ½æäº¤ä¸€å †é›œäº‚ç„¡ç« çš„ commitï¼Œé …ç›®å¾ˆå¿«å°±æœƒè®Šå¾—é›£ä»¥å”èª¿å’Œç¶­è­·ã€‚Vincent Driessen ç‚ºäº†è§£æ±ºé€™å€‹æµç¨‹å’Œè¦ç¯„å•é¡Œæå‡ºäº† A Successful Git Branching Modelï¼Œä»¥ä¸‹æ˜¯åŸºæ–¼ Vincent Driessen æå‡ºçš„ **Git Flow** æµç¨‹åœ–ï¼š

![Untitled](/Untitled_2.png)

Git å¸¸è¦‹åˆ†æ”¯ï¼š

1. ä¸»åˆ†æ”¯ (Main Branches):
    - `main`: é€šå¸¸ç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒï¼Œä»£è¡¨äº†å°ˆæ¡ˆçš„ç•¶å‰ç©©å®šç‰ˆæœ¬ã€‚
    - `dev`: é–‹ç™¼åˆ†æ”¯ï¼Œæ‰€æœ‰çš„æ–°åŠŸèƒ½å’Œä¿®å¾©éƒ½æœƒå…ˆåˆä½µåˆ°é€™è£¡ã€‚
2. åŠŸèƒ½åˆ†æ”¯ (Feature Branches):
    - ç‚ºæ¯å€‹æ–°åŠŸèƒ½æˆ–æ”¹é€²å»ºç«‹ä¸€å€‹æ–°çš„åˆ†æ”¯ã€‚
    - é€™äº›åˆ†æ”¯é€šå¸¸åŸºæ–¼ `dev` å‰µå»ºï¼Œä¸€æ—¦å®Œæˆï¼Œå°‡åˆä½µå› `dev`ã€‚
    - **è‹¥åŒä¸€å€‹åŠŸèƒ½ç”±å¤šäººå”ä½œé–‹ç™¼ï¼Œå¯åŸºæ–¼ `feature` å†è‡ªå»ºåˆ†æ”¯**ã€‚
    - **å„…è©²åŠŸèƒ½`æ­£å¼ç™¼ä½ˆä¸Šç¶«`åï¼Œå¯ç”±Gitç®¡ç†å“¡åˆªé™¤é–‹ç™¼åˆ†æ”¯ã€‚**
3. ç™¼å¸ƒåˆ†æ”¯ (Release Branches):
    - ç•¶ `dev` é”åˆ°ä¸€å€‹ç©©å®šé»ä¸¦ä¸”æº–å‚™ç™¼å¸ƒæ–°ç‰ˆæœ¬æ™‚ï¼ŒåŸºæ–¼ `dev` å»ºç«‹ä¸€å€‹ç™¼å¸ƒåˆ†æ”¯ã€‚
    - åœ¨é€™å€‹åˆ†æ”¯ä¸Šå¯èƒ½æœƒé€²è¡Œä¸€äº›æœ€å¾Œçš„ä¿®å¾©å·¥ä½œæˆ–ç‰ˆæœ¬è™Ÿæ›´æ–°ç­‰ã€‚
    - å®Œæˆå¾Œï¼Œè©²åˆ†æ”¯å°‡åˆä½µåˆ° `main` å’Œ `dev`ã€‚
4. ä¿®å¾©åˆ†æ”¯ (Hotfix Branches):
    - ç”¨æ–¼ç·Šæ€¥ä¿®å¾©ç”Ÿç”¢ç’°å¢ƒä¸­çš„å•é¡Œã€‚
    - åŸºæ–¼ `main` å‰µå»ºï¼Œä¸¦ä¸”ä¿®å¾©å®Œæˆå¾Œå°‡åˆä½µå› `main` å’Œ `dev`ã€‚

## 2.1 åˆ†æ”¯å‘½åè¦ç¯„

- ä¸»åˆ†æ”¯ï¼š**main**
- ä¸»é–‹ç™¼åˆ†æ”¯ï¼š**dev**
- åŠŸèƒ½é–‹ç™¼åˆ†æ”¯ï¼š**feature-***ï¼Œå…¶ä¸­*ç‚ºåŠŸèƒ½ç°¡è¿°åŠ **`ç™¼ä½ˆæ—¥æœŸ`**ï¼Œå¦‚ï¼šfeature-item-list-20231101
- ç™¼å¸ƒåˆ†æ”¯ï¼š**release-***ï¼Œå…¶ä¸­*ç‚ºç‰ˆæœ¬è™Ÿï¼Œå¦‚ï¼šrelease-1.0.0
- ä¿®å¾©åˆ†æ”¯ï¼š**hotfix-***ï¼Œå…¶ä¸­*ç‚ºbugç°¡è¿°ï¼Œå¦‚ï¼šhotfix-item-update-bug
- tagåç¨±ï¼šä¾æ“š**3.1ç‰ˆæœ¬è¦ç¯„å®šç¾©**ï¼Œå¦‚ï¼šv1.0.0

<aside>
ğŸ’¡ ä¸»åˆ†æ”¯é¸æ“‡`main`çš„åŸå› ï¼š
åƒè€ƒ**Github**è¦ç¯„ï¼Œå¾2020å¹´10æœˆ1æ—¥é–‹å§‹ï¼Œæ‰€æœ‰â€œmasteråˆ†æ”¯â€ä¸€å¾‹æ”¹åç‚ºâ€œmainåˆ†æ”¯â€ã€‚èƒŒæ™¯åŸå› æ˜¯ç‚ºäº†æ¨é€²å’Œåæ˜ æ›´åŒ…å®¹æ€§çš„èªè¨€ã€‚ é€™å€‹æ±ºç­–æ˜¯å›æ‡‰äº†æŠ€è¡“ç¤¾ç¾¤ä¸­ä¸€éƒ¨åˆ†äººé—œæ–¼master/slaveè¡“èªçš„è¨è«–ï¼Œé€™äº›è¡“èªåœ¨ä¸€äº›æŠ€è¡“ç’°å¢ƒä¸­ç”¨ä¾†æè¿°ä¸»/å¾é—œä¿‚ã€‚ é€™äº›å­—è©æœ‰å¯èƒ½å–šèµ·èˆ‡å¥´éš¸åˆ¶ç›¸é—œçš„ä¸è‰¯æƒ…ç·’å’Œå›æ†¶ã€‚ å› æ­¤ï¼Œç‚ºäº†ä½¿æŠ€è¡“ç’°å¢ƒæ›´åŠ åŒ…å®¹ï¼ŒGitHub å’Œå…¶ä»–ä¸€äº›çµ„ç¹”å’Œå°ˆæ¡ˆé¸æ“‡ä½¿ç”¨æ›´ä¸­æ€§çš„è¡“èªã€‚

</aside>

### å¾ŒçºŒè¨ˆåŠƒ

å¾… `Jira` å‰µå»ºåï¼Œæ ¹æ“šéœ€æ±‚ç·¨è™Ÿå’Œbugç·¨è™Ÿå®šç¾©åˆ†æ”¯ï¼Œä¸¦èˆ‡ä¹‹é—œè¯ã€‚

## 2.2 æ“ä½œæµç¨‹

- æ–°åŠŸèƒ½é–‹ç™¼æ™‚ï¼Œå¾ `dev` åˆ†æ”¯å»ºç«‹ä¸€å€‹æ–°çš„ `feature` åˆ†æ”¯ï¼ŒæŒ‰è¦ç¯„å‘½åï¼›
- åŠŸèƒ½é–‹ç™¼å®Œæˆå¾Œï¼Œå°‡ `feature` åˆ†æ”¯åˆä½µå› `dev` ï¼›
- ç•¶ `dev` æº–å‚™å¥½é€²è¡Œæ–°ç‰ˆæœ¬ç™¼ä½ˆæ™‚ï¼Œå»ºç«‹ä¸€å€‹ `release` åˆ†æ”¯ï¼›
- å¦‚æœ `release` åˆ†æ”¯ä¸­ç™¼ç¾å•é¡Œï¼Œä¿®å¾©å¾Œï¼Œå†åˆä½µå› `main` å’Œ `dev`ã€‚
- å¦‚æœ**ç”Ÿç”¢ç’°å¢ƒ**ä¸­å‡ºç¾ç·Šæ€¥å•é¡Œï¼Œå¾ `main` å»ºç«‹ä¸€å€‹ `hotfix` åˆ†æ”¯ï¼Œä¿®å¾©å¾Œï¼Œåˆä½µå›  `main` å’Œ `dev` ï¼›

ç¢ºä¿æ‰€æœ‰åœ˜éšŠæˆå“¡éƒ½äº†è§£ä¸¦éµå¾ªé€™å·¥ä½œæµç¨‹æ˜¯å¾ˆé‡è¦çš„ï¼Œé€™å¯ä»¥ç¢ºä¿ç¨‹å¼ç¢¼çš„ç©©å®šæ€§ï¼Œç°¡åŒ–ç‰ˆæœ¬ç®¡ç†ï¼Œä»¥åŠä½¿åœ˜éšŠæˆå“¡ä¹‹é–“çš„å”ä½œæ›´åŠ é †æš¢ã€‚

å¸¸è¦‹æ“ä½œè¦ç¯„ï¼š

1. é …ç›®åˆå§‹åŒ–

```bash
# æ–¹å¼1: å…ˆå…‹éš†é ç«¯å€‰åº«åˆ°æœ¬åœ°
git clone https://xxx.git

cd xxx
git add .               
git commit -m 'åˆå§‹åŒ–é¡¹ç›®' 
git push  	          

# æ–¹å¼2: æœ¬åœ°é …ç›®é—œè¯é ç«¯å€‰åº«ä½å€
git remote add origin https://xxx.git
git push -u origin main 
```

1. é–‹ç™¼æäº¤ä»£ç¢¼æµç¨‹

```bash
# 1. ç¬¬ä¸€æ¬¡æ‹‰å–
# å…‹éš†å€‰åº«åˆ°æœ¬åœ°
git clone https://xxx.git
# åˆ‡æ›åˆ°é–‹ç™¼åˆ†æ”¯
git checkout dev
# æ–°å»ºåŠŸèƒ½çš„é–‹ç™¼åˆ†æ”¯
git checkout -b feature-app-login
# addã€commitã€pushã€pull request

# 2. å¾ŒçºŒé–‹ç™¼
# è‹¥æœ‰æœªå®Œæˆçš„ç¨‹å¼ç¢¼å…ˆæš«å­˜
git stash
# åˆ‡æ›åˆ°devé–‹ç™¼åˆ†æ”¯
git checkout dev
# æ›´æ–°åˆ†æ”¯
git pull
# åˆ‡æ›å›é–‹ç™¼åˆ†æ”¯
git checkout feature-app-login
# åˆä½µdevåˆ†æ”¯åˆ°é–‹ç™¼åˆ†æ”¯
git merge dev
# ç¹¼çºŒé–‹ç™¼ addã€commitã€pushã€pull request
```

<aside>
ğŸ’¡ commit æäº¤æµç¨‹æœ‰å·¥å…·è¼”åŠ©è¦ç¯„æäº¤ï¼Œè«‹çœ‹ä¸‹ä¸€ç¯€**3.3**ã€‚

</aside>

# 3. ç¨‹å¼ç¢¼æäº¤èˆ‡ç´„æŸ

## 3.1 commit è¦ç¯„åŒ–çš„é‡è¦æ€§

åœ¨ä¸­å¤§å‹é …ç›®å’Œå¤šäººå”ä½œçš„ç’°å¢ƒä¸­ï¼Œæäº¤è³‡è¨Šè¦ç¯„è¦ç¯„éå¸¸é‡è¦ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦ç”¨é€”å’Œå¥½è™•ï¼š

- **æä¾›æ¸…æ™°çš„æ­·å²è¨˜éŒ„**ï¼šè¦ç¯„åŒ–çš„æäº¤è³‡è¨Šä½¿å¾—å…¶ä»–é–‹ç™¼è€…æ›´å®¹æ˜“ç†è§£æ¯æ¬¡æäº¤çš„ç›®çš„å’Œä¸Šä¸‹æ–‡ã€‚
- **ä¾¿æ–¼ç¨‹å¼ç¢¼å¯©æŸ¥**ï¼šç•¶é€²è¡Œç¨‹å¼ç¢¼å¯©æŸ¥æ™‚ï¼Œæ¸…æ™°å’Œå…·é«”çš„æäº¤è³‡è¨Šå¯ä»¥å¹«åŠ©å¯©æŸ¥è€…æ›´å¥½åœ°ç†è§£ç¨‹å¼ç¢¼çš„è®Šæ›´ä»¥åŠç‚ºä»€éº¼è¦é€²è¡Œé€™äº›è®Šæ›´ã€‚
- **è‡ªå‹•ç”¢ç”Ÿæ›´æ”¹æ—¥èªŒ**ï¼šç¬¦åˆè¦ç¯„çš„æäº¤è³‡è¨Šå¯ä»¥è¢«å·¥å…·è­˜åˆ¥å’Œè§£æï¼Œé€™æ¨£å¯ä»¥è‡ªå‹•å¾æäº¤è³‡è¨Šä¸­ç”¢ç”Ÿæ›´æ”¹æ—¥èªŒï¼Œä¾‹å¦‚ä½¿ç”¨ semantic-release æˆ– standard-versionã€‚
- **æ›´æ˜“æ–¼è¿½è¹¤å’Œä¿®å¾©å•é¡Œ**ï¼šç•¶åœ¨ç¨‹å¼ç¢¼ä¸­ç™¼ç¾å•é¡Œæˆ–éœ€è¦å›æ»¾è®Šæ›´æ™‚ï¼Œæœ‰è¦ç¯„çš„æäº¤è³‡è¨Šå¯ä»¥æ›´å¿«åœ°æ‰¾åˆ°ä¸¦ç†è§£å•é¡Œæ‰€åœ¨ã€‚
- **ä¿ƒé€²åœ˜éšŠå”ä½œ**ï¼šæœ‰çµ±ä¸€çš„æäº¤è³‡è¨Šè¦ç¯„ç¢ºä¿äº†æ•´å€‹åœ˜éšŠéµå¾ªç›¸åŒçš„æ¨™æº–ï¼Œé€™æœ‰åŠ©æ–¼åœ˜éšŠæˆå“¡ä¹‹é–“çš„æºé€šå’Œå”ä½œã€‚
- **ä¾¿æ–¼ç¯©é¸å’Œå°‹æ‰¾ç‰¹å®šæ›´æ”¹**ï¼šå¦‚æœéœ€è¦æŸ¥æ‰¾ç‰¹å®šé¡å‹çš„è®Šæ›´ï¼ˆä¾‹å¦‚æ‰€æœ‰çš„ bug ä¿®å¾©æˆ–æ–°åŠŸèƒ½ï¼‰ï¼Œå‰‡è¦ç¯„çš„æäº¤è³‡è¨Šå¯ä»¥ä½¿æ­¤éç¨‹è®Šå¾—æ›´ç‚ºç°¡å–®ã€‚

ç¸½è€Œè¨€ä¹‹ï¼Œå° `git commit message` é€²è¡Œè¦ç¯„åŒ–ä¸åƒ…ä½¿å¾—ç‰ˆæœ¬æ­·å²æ›´åŠ æ¸…æ™°å’Œæœ‰åºï¼Œè€Œä¸”å¯ä»¥æé«˜é–‹ç™¼æ•ˆç‡ï¼Œä¿ƒé€²åœ˜éšŠå”ä½œï¼Œä¸¦åˆ©ç”¨å·¥å…·å¯¦ç¾è‡ªå‹•åŒ–çš„æ›´æ”¹æ—¥èªŒç”Ÿæˆå’Œç‰ˆæœ¬æ§åˆ¶ã€‚ åœ¨å¤§å‹é …ç›®ä¸­ï¼Œé€™æ˜¯ç¶­è­·é …ç›®çš„é—œéµéƒ¨åˆ†ã€‚

## 3.2 commit message è¦ç¯„

commit messageç´„å®šï¼šåŸºæ–¼ **`Angular è¦ç¯„`** æ”¹ç·¨ã€‚

- `<header>`ï¼š`<type>(<scope>): <summary>` å¿…å¡«ï¼Œ**`scope å¯é¸`**
- `<body>` å¯é¸
- `<footer>` å¯é¸

```bash
**Commit Message Headerï¼š**

<type>(<scope>): <summary>
  â”‚       â”‚             â”‚
  â”‚       â”‚             â””â”€â«¸ Summary in present tense. Not capitalized. No period at the end.
  â”‚       â”‚
  â”‚       â””â”€â«¸ Commit Scope: animations|bazel|benchpress|common|compiler|compiler-cli|core|
  â”‚                          elements|forms|http|language-service|localize|platform-browser|
  â”‚                          platform-browser-dynamic|platform-server|router|service-worker|
  â”‚                          upgrade|zone.js|packaging|changelog|docs-infra|migrations|
  â”‚                          devtools
  â”‚
  â””â”€â«¸ Commit Type: feat|fix|docs|style|refactor|perf|test|chore
```

**typeï¼šcommit é¡å‹ï¼š**

- `feat`ï¼šæ–°åŠŸèƒ½
- `fix`ï¼šä¿®è£œbug
- `docs`ï¼šä¿®æ”¹æ–‡æª”
- `style`ï¼š æ ¼å¼åŒ–ç¨‹å¼ç¢¼çµæ§‹ï¼ˆä¸å½±éŸ¿ç¨‹å¼ç¢¼é‹ä½œçš„è®Šå‹•ï¼‰
- `refactor`ï¼šé‡æ§‹ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ç¨‹å¼ç¢¼è®Šå‹•ï¼Œä¾‹å¦‚é‡æ–°å‘½åè®Šæ•¸ï¼‰
- `perf`: æ€§èƒ½å„ªåŒ–
- `test`: å¢åŠ æˆ–ä¿®æ”¹æ¸¬è©¦æ¡ˆä¾‹
- `chore`ï¼šå»ºç½®éç¨‹æˆ–è¼”åŠ©å·¥å…·çš„è®Šå‹•ï¼ˆä¸æœƒå½±éŸ¿ç¨‹å¼ç¢¼é‹è¡Œï¼‰

**scope: å®šç¾©typeå½±éŸ¿çš„ç¯„åœï¼Œä¾‹æ¥­å‹™æ¨¡çµ„ã€å…¬å…±çµ„ç­‰ç­‰ï¼Œè¦–é …ç›®ä¸åŒè€Œä¸åŒï¼Œä»¥ä¸‹å¯ä¾›åƒè€ƒã€‚**

- coreï¼šæ ¸å¿ƒæ¨¡çµ„
- compilerï¼šç·¨è­¯å™¨ç›¸é—œ
- httpï¼šè«‹æ±‚ç›¸é—œ
- componentï¼šçµ„ä»¶ç›¸é—œ
- upgradeï¼šå‡ç´šç›¸é—œ
- loginï¼šã€æ¥­å‹™ã€‘ç™»éŒ„æ¨¡çµ„
- user-profileï¼šã€æ¥­å‹™ã€‘ç”¨æˆ¶æ¨¡çµ„

**summary**: **æäº¤ä¿¡æ¯ç°¡è¿°ã€‚**

- commit ç›®çš„çš„ç°¡çŸ­æè¿°ã€‚ å¯ä»¥å¯«ä¸­æ–‡ï¼Œæ³¨æ„commité¦–å€‹æ˜¯ç©ºæ ¼

ä¾‹å¦‚ï¼š

```bash
feat(compiler): add 'comments' option

fix(release): need to depend on latest rxjs and zone.js
The version in our package.json gets copied to the one we publish, and users need the latest of these.

perf(core): improve the ngFor performance
BREAKING CHANGE: `trackBy` now takes a second argument when used in `NgFor`.
```

<aside>
ğŸ’¡ çˆ²äº†æ›´ç›´è§€å’Œè¦ç¯„`scope`ï¼Œå¾ŒçºŒåªéœ€å°‡`Jira` æœ‰éœ€æ±‚ç·¨è™Ÿæˆ–bugç·¨è™Ÿçš„å¡«å¯«é€²`scope`ï¼Œå…¶ä»–æƒ…æ³å¯ä¸å¡« `scope`.

</aside>

## 3.3 commit æäº¤æµç¨‹

ç¨‹å¼ç¢¼é–‹ç™¼å®Œæˆå¾Œï¼Œå°‡ç¨‹å¼ç¢¼æäº¤åˆ°é ç¨‹å€‰åº«éœ€è¦åšä¸€å®šçš„è¦ç¯„é™åˆ¶æäº¤ï¼Œé˜²æ­¢å‡ºç¾ä¸åŒçš„ç¨‹å¼ç¢¼é¢¨æ ¼å…¥åº«å°è‡´åˆä½µè¡çªã€‚ æäº¤æµç¨‹ä¸­ç”¨åˆ°çš„è¼”åŠ©å·¥å…·æœ‰ï¼š

- **husky**: ç•¶ä½ å˜—è©¦é€²è¡Œ`git commit`ï¼Œhusky æœƒè§¸ç™¼é å…ˆé…ç½®çš„ Git é‰¤å­ï¼ˆå¦‚ `pre-commit`ï¼‰ã€‚é€™æ˜¯ä½ é–‹å§‹æ•´å€‹æäº¤éç¨‹çš„å…¥å£é»;
- **lint-staged:** å¦‚æœä½ åœ¨ husky çš„ `pre-commit` é‰¤å­ä¸­é…ç½®äº† `lint-staged`ï¼Œå‰‡å®ƒæœƒåœ¨ä½ åŸ·è¡Œ `git commit` æ™‚é‹è¡Œ;
- **commitizen:** æä¾›ä¸€å€‹**äº’å‹•å¼ä»‹é¢**å¹«åŠ©ä½ å»ºæ§‹è¦ç¯„åŒ–çš„æäº¤ä¿¡æ¯ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨å‘½ä»¤`npm run commit`ä¾†åŸ·è¡Œä»£ç¢¼æäº¤ï¼›
- **commitlint:** ä¸€æ—¦ä½ æœ‰äº†æäº¤è³‡è¨Šï¼ˆç„¡è«–æ˜¯ç›´æ¥é€é `git commit` é‚„æ˜¯é€é `commitizen` ç²å¾—çš„ï¼‰ï¼Œhusky å¯ä»¥è§¸ç™¼ `commit-msg` é‰¤å­ã€‚åœ¨ `commit-msg` é‰¤å­ä¸­ï¼Œ`commitlint` æœƒæª¢æŸ¥æäº¤è³‡è¨Šæ˜¯å¦ç¬¦åˆé è¨­çš„è¦ç¯„ã€‚ å¦‚æœæäº¤è³‡è¨Šä¸ç¬¦åˆé æœŸï¼Œæäº¤å°‡ä¸­æ–·ã€‚

![Untitled](/Untitled.jpeg)

å¤§è‡´**æäº¤**æµç¨‹ç‚ºï¼š

1. åŸ·è¡Œ`npm run commit` é‹è¡Œ`commitizen` åœ¨äº’å‹•å¼ä»‹é¢åˆ›å»ºæäº¤ä¿¡æ¯**ï¼ˆå‰æå·²é…ç½®å¥½ä»¥ä¸Šå·¥å…·åŠè…³æœ¬ï¼‰**ï¼›
2. è§¸ç™¼huskyé‰¤å­pre-commitï¼šé‹è¡Œ`lint-staged` ï¼ŒåŸ·è¡Œ `eslint` å’Œ `prettier` æ ¼å¼åŒ–ä»£ç¢¼ï¼›
3. è§¸ç™¼huskyé‰¤å­commit-msgï¼šèª¿ç”¨ `commitlint` æª¢æŸ¥ä½ çš„æäº¤ä¿¡æ¯ï¼Œè‹¥æ˜¯æŒ‰è¦ç¯„å‰µå»ºçš„æäº¤ä¿¡æ¯ï¼Œå‰‡æˆåŠŸæäº¤ã€‚

ä»¥ä¸Šä»»ä½•æ­¥é©Ÿå‡ºç¾å•é¡Œéƒ½å¯èƒ½å°è‡´æäº¤å¤±æ•—ï¼ŒåŒ…æ‹¬eslintä»£ç¢¼è¦ç¯„ã€prettieræ ¼å¼åŒ–è¦ç¯„ã€commit messageä¿¡æ¯è¦ç¯„ã€‚

## 3.4 å®‰è£å’Œé…ç½®ç›¸é—œå·¥å…·

1. å®‰è£…gité‰¤å­å·¥å…· husky å’Œ lint-staged

```bash
npm install husky lint-staged -D
```

1. åˆå§‹åŒ– husky ä¸¦é…ç½® **pre-commit** é‰¤å­

```bash
npx husky-init
```

åˆå§‹åŒ–å®Œæˆåä¼šé»˜è®¤ç”Ÿæˆï¼š

- package.json ç”Ÿæˆä¸€å€‹scriptè…³æœ¬ï¼š `"prepare": "husky install"`
- `.husky` æ–‡ä»¶å¤¹ï¼ŒåŒ…å« `pre-commit` æ–‡ä»¶

ä¿®æ”¹ pre-commit æ–‡ä»¶ï¼Œæ·»åŠ lint-stagedåŸ·è¡Œå‘½ä»¤ï¼š

```bash
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npx lint-staged
```

package.json ä¸­æ·»åŠ  `lint-staged` é…ç½®ï¼š

```bash
# æäº¤å‰å…ˆå°ä»£ç¢¼é€²è¡Œæ ¼å¼åŒ–å€‹è¦å‰‡æ ¡é©—
"lint-staged": {
    "*.{vue,js,jsx,cjs,mjs,ts,tsx,cts,mts}": [
      "eslint --fix",
      "prettier --write"
    ]
}
```

ç°åœ¨ï¼Œæ¯æ¬¡ä½ å°è¯•æäº¤ä»£ç æ—¶ï¼Œhusky å°†è§¦å‘ `lint-staged`ï¼Œç„¶å `lint-staged` å°†è¿è¡Œ `eslint` æ¥æ£€æŸ¥å¹¶å°è¯•ä¿®å¤ä½ æš‚å­˜çš„æ–‡ä»¶ã€‚å¦‚æœå­˜åœ¨**ä¸ç¬¦åˆ** ESLint è§„åˆ™çš„ä»£ç ï¼Œæäº¤å°†è¢«**ä¸­æ–­**ï¼Œä»è€Œç¡®ä¿æ‰€æœ‰æäº¤çš„ä»£ç éƒ½ç¬¦åˆè§„èŒƒã€‚

1. é…ç½®commitizenäº’å‹•å¼ä»‹é¢æäº¤å·¥å…·

```bash
# å®‰è£å·¥å…·
npm install commitizen cz-conventional-changelog -D
```

`cz-conventional-changelog` æ˜¯ä¸€å€‹ `commitizen` çš„é©é…å™¨ï¼Œç”¨æ–¼æŒ‰ç…§**ã€ŒConventional Commitsã€**è¦ç¯„æ ¼å¼åŒ– commit è³‡è¨Šã€‚ç•¶èˆ‡ **commitizen** ä¸€èµ·ä½¿ç”¨æ™‚ï¼Œå®ƒæä¾›äº†ä¸€ç¨®æ–¹æ³•ï¼Œé€éå‘½ä»¤åˆ—ä»‹é¢å¼•å°é–‹ç™¼è€…è¼¸å…¥ç¬¦åˆ**ã€ŒConventional Commitsã€**è¦ç¯„çš„ commit è³‡è¨Šã€‚åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•çš„ **package.json** ä¸­æ·»åŠ  **config** éƒ¨åˆ†:

```bash
{
  "config": {
    "commitizen": {
      "path": "./node_modules/cz-conventional-changelog"
    }
  }
}
```

ä½¿ç”¨ `npx cz` æäº¤ï¼Œç‚ºäº†æ–¹ä¾¿ï¼Œå¯ä»¥åœ¨scriptsä¸­åŠ ä¸€å€‹è…³æœ¬ï¼š`"commit": "npx czâ€`ï¼Œé€™æ¨£å°±å¯ä»¥ç”¨ `npm run commit`ä¾†åšæäº¤æ“ä½œã€‚

1. è‡ªå®šä¹‰commitè¦ç¯„

é»˜èª`cz-conventional-changelog` æä¾›äº†ä¸å°‘çš„typeå’Œå…¶ä»–é…ç½®ï¼Œæ ¹æ“šå¯¦éš›é …ç›®éœ€æ±‚å¯ä»¥èª¿æ•´è‡ªè¨‚typeå’Œscopeç­‰é…ç½®ã€‚

å®‰è£è‡ªå®šç¾©è¦ç¯„æ’ä»¶ï¼š

```bash
npm i commitlint-config-cz cz-customizable -D
```

åœ¨é …ç›®æ ¹ç›®éŒ„ä¸‹å‰µå»ºé…ç½®æ–‡ä»¶`.cz-config.js` ï¼š

```jsx
module.exports = {
  types: [
    { value: 'feat', name: 'feat:     å¢åŠ æ–°åŠŸèƒ½' },
    { value: 'fix', name: 'fix:      ä¿®å¾©bug' },
    { value: 'docs', name: 'docs:     ä¿®æ”¹æ–‡æª”' },
    { value: 'style', name: 'style:    æ ¼å¼åŒ–ä»£ç¢¼çµæ§‹' },
    { value: 'refactor', name: 'refactor: ä»£ç¢¼é‡æ§‹' },
    { value: 'perf', name: 'perf:     æ€§èƒ½å„ªåŒ–' },
    { value: 'test', name: 'test:     å¢åˆ æµ‹è¯•' },
    { value: 'chore', name: 'chore:    å°æ§‹å»ºéç¨‹æˆ–è¼”åŠ©å·¥å…·å’Œåº«çš„æ›´æ”¹' }
  ],
  scopes: [
    { name: 'components' },
    { name: 'utils' },
    { name: 'styles' },
    { name: 'i18n' },
    { name: 'router' },
    { name: 'store' },
    { name: 'test' },
    { name: 'user' },
    { name: 'search' }
  ],
  messages: {
    type: 'é€‰æ‹©æ›´æ”¹ç±»å‹:\n',
    scope: 'é€‰æ‹©ä¸€ä¸ª scope\n',
    subject: 'ç®€çŸ­æè¿°:\n',
    body: 'è¯¦ç»†æè¿°. ä½¿ç”¨"|"æ¢è¡Œ:\n',
    breaking: 'Breaking Changesåˆ—è¡¨:\n',
    footer: 'å…³é—­çš„issuesåˆ—è¡¨. E.g.: #31, #34:\n',
    confirmCommit: 'ç¡®è®¤æäº¤?'
  },
  allowCustomScopes: false
}
```

<aside>
ğŸ’¡ `scope` å®šç¾©å¯æ ¹æ“šå…·é«”é …ç›®é…ç½®ï¼Œä»¥ä¸Šåƒ…ä¾›å‰ç«¯é …ç›®åƒè€ƒã€‚

</aside>

ä¿®æ”¹package.jsoné…ç½®ï¼š

```jsx
// ä¿®æ”¹å‰
"config": {
  "commitizen": {
    "path": "./node_modules/cz-conventional-changelog"
  }
}

// ä¿®æ”¹å¾Œ
"config": {
  "cz-customizable": {
    "config": "./cz-config.js"
  }
}
```

åœ¨é …ç›®æ ¹ç›®éŒ„æ–°å»ºé…ç½®æ–‡ä»¶æ–‡ä»¶`.czrc` ï¼š

```
{
  "path": "cz-customizable"
}
```

1. é…ç½®commitlintæäº¤è¦ç¯„æ ¡é©—

å¦‚æœæ²’æœ‰ä½¿ç”¨commitizenæäº¤æˆ–è€…æäº¤ä¿¡æ¯ä¸ç¬¦åˆè¦ç¯„å°±ä¸å…è¨±æäº¤ï¼Œå¯ä»¥ä½¿ç”¨commitlintå·¥å…·ä¾†åšæ ¡é©—ï¼š

```bash
npm install @commitlint/{config-conventional,cli} -D
```

åœ¨é …ç›®æ ¹ç›®å½•åˆ›å»º `commitlint.config.js` æ–‡ä»¶ï¼Œé…ç½® `commitlint` ï¼š

```jsx
module.exports = {
  extends: ['@commitlint/config-conventional'],
  rules: {
    'type-enum': [
      2,
      'always',
      ['feat', 'fix', 'docs', 'style', 'refactor', 'perf', 'test', 'chore']
    ],
    'scope-enum': [
      2,
      'always',
      ['components', 'utils', 'styles', 'i18n', 'router', 'store', 'test', 'user', 'search']
    ]
  }
}
```

ä½¿ç”¨huskyç”Ÿæˆcommit-msgæ–‡ä»¶ï¼Œæäº¤å‰éªŒè¯æäº¤ä¿¡æ¯

```jsx
npx husky add .husky/commit-msg "npx --no-install commitlint --edit $1"
```

é…ç½®å®Œæˆåï¼Œåˆ™æäº¤ä¿¡æ¯å¿…é¡»ç¬¦åˆ `commitlint` è§„åˆ™æ‰å¯ä»¥æäº¤ï¼Œå¦åˆ™ä¼šç¦æ­¢æäº¤ã€‚